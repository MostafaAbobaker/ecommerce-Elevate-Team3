<section>
    <p-steps [model]="[
  {label: 'Enter address details'},
  {label: 'Find Your Location'}
]" [activeIndex]="stepIndex"></p-steps>

    <!-- Step 1 -->
    <div *ngIf="stepIndex === 0" class="p-4">
        <form [formGroup]="addressForm">
            <input pInputText class="w-full my-2" formControlName="city" placeholder="Enter city name">
            @if (addressForm.get('city')?.errors && addressForm.get('city')?.touched) {
            <div class="flex text-sm text-red-800 rounded-lg dark:bg-gray-800 dark:text-red-400" role="alert">
                <ul class="list-disc list-inside">
                    <li>City is required</li>
                </ul>
            </div>
            }
            <textarea pTextarea class="w-full my-2" formControlName="street"
                placeholder="Enter your full address"></textarea>
            @if (addressForm.get('street')?.errors && addressForm.get('street')?.touched) {
            <div class="flex text-sm text-red-800 rounded-lg dark:bg-gray-800 dark:text-red-400" role="alert">
                <ul class="list-disc list-inside">
                    <li>Street is required</li>
                </ul>
            </div>
            }
            <!-- <ngx-intl-tel-input [cssClass]="'custom'"
                [preferredCountries]="[CountryISO.UnitedStates, CountryISO.UnitedKingdom]"
                [enableAutoCountrySelect]="false" [enablePlaceholder]="true" [searchCountryFlag]="true"
                [searchCountryField]="[SearchCountryField.Iso2, SearchCountryField.Name]" [selectFirstCountry]="false"
                [selectedCountryISO]="CountryISO.India" [maxLength]="15" [phoneValidation]="true"
                name="phone" formControlName="phone" class="w-full my-2" >
            </ngx-intl-tel-input> -->
            <input pInputText class="w-full my-2" formControlName="phone" placeholder="Phone number">
            @if (addressForm.get('phone')?.errors && addressForm.get('phone')?.touched) {
            <div class="flex text-sm text-red-800 rounded-lg dark:bg-gray-800 dark:text-red-400" role="alert">
                <ul class="list-disc list-inside">
                    <li>Phone is required</li>
                </ul>
            </div>
            }
            <input pInputText class="w-full my-2" formControlName="username" placeholder="Your name">
            @if (addressForm.get('username')?.errors && addressForm.get('username')?.touched) {
            <div class="flex text-sm text-red-800 rounded-lg dark:bg-gray-800 dark:text-red-400" role="alert">
                <ul class="list-disc list-inside">
                    <li>User name is required</li>
                </ul>
            </div>
            }
        </form>
        <button pButton label="Next" class="p-button-danger w-full mt-1" [disabled]="addressForm.invalid"
            (click)="nextStep()"></button>
    </div>

    <!-- Step 2 -->
    <div *ngIf="stepIndex === 1" class="p-4">
        <h3>Find Your Location</h3>
        <button pButton label="Find My Location" icon="pi pi-map-marker" class="p-button-outlined mb-2"
            (click)="findMyLocation()"></button>

        <google-map height="400px" width="100%" [center]="{lat: latitude, lng: longitude}" [zoom]="zoom"
            (mapClick)="onMapClick($event)">
            <map-marker [position]="{lat: latitude, lng: longitude}" [options]="{draggable: true}"
                (mapDragend)="onMapClick($event)">
            </map-marker>
        </google-map>

        <div class="mt-3">
            <button pButton [label]="addressId ? 'Update Address' : 'Add Address'" class="p-button-danger w-full"
                (click)="saveAddress()"></button>
        </div>
    </div>

</section>